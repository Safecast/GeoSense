define(["jquery","underscore","backbone","models/map-layer","deepextend","deepmodel"],function(e,t,n,r){var i=n.DeepModel.extend({idAttribute:"slug",urlRoot:BASE_URL+"api/map",url:function(){return this.urlRoot+"/"+this.publicUri({omitSlug:!1})},isPrivate:function(){return this.attributes.sharing!=SharingType.WORLD},adminUri:function(e){var n=this.publicUri(t.extend({slug:this.attributes.slug},e));return"admin"+(n!=""?"/"+n:"")},publicUri:function(e){var t=e||{},n=this.isCustomHost&&(t.omitSlug||t.omitSlug==undefined),r=t.secret!=undefined?t.secret:this.isPrivate(),i=(n?"":t.slug?t.slug:r?"s/"+this.attributes.secretSlug:this.attributes.slug)+(t.view?"/"+t.view:"");return t.x!=undefined&&t.y!=undefined&&(i+="/"+(t.x||0)+","+(t.y||0),t.zoom!=undefined&&(i+=","+t.zoom)),i},adminUrl:function(e){return BASE_URL+this.adminUri(e)},publicUrl:function(e){var n=BASE_URL,r=t.extend({},e);return this.attributes.host&&this.attributes.host!=""&&(r.omitSlug=!0,n="http://"+this.attributes.host+"/"),n+this.publicUri(r)},newLayerInstance:function(e,t){var t=t||{};return t.parentMap=this,new r(e,t)}});return i});