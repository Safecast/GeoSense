define(["jquery","underscore","backbone"],function(e,t,n){var r={initScrollable:function(n,r,i,s){var o=this;this.lastPage=!0,this.searchParams={p:0},this.resultHeight=i||50,this.$scrollable=t.isString(n)?this.$(n):e(n),this.$scrollContent=t.isString(r)?this.$(r):e(r),this.$scrollable.on("scroll resize",function(t){clearTimeout(e.data(this,"scrollTimer")),e.data(this,"scrollTimer",setTimeout(function(){o.updateAfterScrolled(t)},250))})},scrollableHeight:function(){var e=this.$scrollable.height();return this.$scrollable.offset()||(e-=this.$scrollContent.offset().top),e},detectPageLimit:function(){return Math.max(1,Math.ceil(this.scrollableHeight()/this.resultHeight/10))*10},resetPageParams:function(){return this.isLastPage=!1,this.searchParams.p=0,this.searchParams.l=this.detectPageLimit(),this},updateAfterScrolled:function(e){var t=this.$scrollable.scrollTop()+this.scrollableHeight()-this.$scrollContent.height();if(t>-50){if(!this.loadNextPage){console.error("View needs to implement loadNextPage()");return}this.loadNextPage()}}};return r});