var map;(function(){function f(){var e=o.tileFullExtent,t=e.getCenterLonLat(),n=map.getZoomForExtent(e,!0),r=OpenLayers.Util.getParameters("?"+window.location.hash.substr(1));OpenLayers.Util.applyDefaults(r,{x:t.lon,y:t.lat,z:n}),map.setCenter(new OpenLayers.LonLat(r.x,r.y),r.z)}document.documentElement.lang=(navigator.userLanguage||navigator.language).split("-")[0];var e=new OpenLayers.Control.Panel({displayClass:"layerPanel",autoActivate:!0}),t=new OpenLayers.Control({type:OpenLayers.Control.TYPE_TOOL,displayClass:"aerialButton",eventListeners:{activate:function(){u&&map.setBaseLayer(u)}}}),n=new OpenLayers.Control({type:OpenLayers.Control.TYPE_TOOL,displayClass:"mapButton",eventListeners:{activate:function(){o&&map.setBaseLayer(o)}}}),r=new OpenLayers.Control({type:OpenLayers.Control.TYPE_TOGGLE,displayClass:"labelButton",eventListeners:{activate:function(){a&&a.setVisibility(!0)},deactivate:function(){a&&a.setVisibility(!1)}}});e.addControls([t,n,r]);var i=new OpenLayers.Control.ZoomPanel;i.addControls([new OpenLayers.Control.Geolocate({type:OpenLayers.Control.TYPE_TOGGLE,geolocationOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:7e3},eventListeners:{activate:function(){map.addLayer(s)},deactivate:function(){map.removeLayer(s),s.removeAllFeatures()},locationupdated:function(e){s.removeAllFeatures(),s.addFeatures([new OpenLayers.Feature.Vector(e.point,null,{graphicName:"cross",strokeColor:"#f00",strokeWidth:2,fillOpacity:0,pointRadius:10}),new OpenLayers.Feature.Vector(OpenLayers.Geometry.Polygon.createRegularPolygon(new OpenLayers.Geometry.Point(e.point.x,e.point.y),e.position.coords.accuracy/2,50,0),null,{fillOpacity:.1,fillColor:"#000",strokeColor:"#f00",strokeOpacity:.6})]),map.zoomToExtent(s.getDataExtent())}}})]),map=new OpenLayers.Map({div:"map",theme:null,projection:"EPSG:3857",units:"m",maxExtent:[-20037508.34,-20037508.34,20037508.34,20037508.34],maxResolution:156543.0339,numZoomLevels:20,controls:[new OpenLayers.Control.Navigation({mouseWheelOptions:{cumulative:!1,interval:20},dragPanOptions:{enableKinetic:{deceleration:.02}},zoomBoxEnabled:!1}),new OpenLayers.Control.Attribution,i,e],eventListeners:{moveend:function(){var e=map.getCenter();window.location.hash="x="+e.lon+"&y="+e.lat+"&z="+map.getZoom()}}}),e.activateControl(n),e.activateControl(r);var s=new OpenLayers.Layer.Vector("Vector Layer"),o,u,a;OpenLayers.ProxyHost="proxy.cgi?url=",OpenLayers.Request.GET({url:"http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml",success:function(e){var t=new OpenLayers.Format.WMTSCapabilities,n={requestEncoding:"REST",matrixSet:"google3857",attribution:'Datenquelle: Stadt Wien - <a href="http://data.wien.gv.at">data.wien.gv.at</a>'},r=e.responseText,i=t.read(r);o=t.createLayer(i,OpenLayers.Util.applyDefaults({layer:"fmzk",requestEncoding:"REST",transitionEffect:"resize"},n)),u=t.createLayer(i,OpenLayers.Util.applyDefaults({layer:"lb",requestEncoding:"REST",transitionEffect:"resize"},n)),a=t.createLayer(i,OpenLayers.Util.applyDefaults({layer:"beschriftung",requestEncoding:"REST",isBaseLayer:!1},n)),map.addLayers([o,u,a]),f()}})})(),function(){var e=document.getElementById("map"),t=navigator.userAgent,n=~t.indexOf("iPhone")||~t.indexOf("iPod"),r=~t.indexOf("iPad"),i=n||r,s=window.navigator.standalone,o=~t.indexOf("Android"),u=0;o&&(window.onscroll=function(){e.style.height=window.innerHeight+"px"});var a=window.onload=function(){if(i){var t=document.documentElement.clientHeight;n&&!s&&(t+=60),e.style.height=t+"px"}else o&&(e.style.height=window.innerHeight+56+"px");setTimeout(scrollTo,0,0,1)};(window.onresize=function(){var t=e.offsetWidth;if(u==t)return;u=t,a()})()}();