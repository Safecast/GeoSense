/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */

OpenLayers.Format.Text=OpenLayers.Class(OpenLayers.Format,{defaultStyle:null,extractStyles:!0,initialize:function(e){e=e||{},e.extractStyles!==!1&&(e.defaultStyle={externalGraphic:OpenLayers.Util.getImageLocation("marker.png"),graphicWidth:21,graphicHeight:25,graphicXOffset:-10.5,graphicYOffset:-12.5}),OpenLayers.Format.prototype.initialize.apply(this,[e])},read:function(e){var t=e.split("\n"),n,r=[];for(var i=0;i<t.length-1;i++){var s=t[i].replace(/^\s*/,"").replace(/\s*$/,"");if(s.charAt(0)!="#")if(!n)n=s.split("	");else{var o=s.split("	"),u=new OpenLayers.Geometry.Point(0,0),a={},f=this.defaultStyle?OpenLayers.Util.applyDefaults({},this.defaultStyle):null,l,c,h,p,d=!1;for(var v=0;v<o.length;v++)if(o[v])if(n[v]=="point"){var m=o[v].split(",");u.y=parseFloat(m[0]),u.x=parseFloat(m[1]),d=!0}else if(n[v]=="lat")u.y=parseFloat(o[v]),d=!0;else if(n[v]=="lon")u.x=parseFloat(o[v]),d=!0;else if(n[v]=="title")a.title=o[v];else if(n[v]=="image"||n[v]=="icon"&&f)f.externalGraphic=o[v];else if(n[v]=="iconSize"&&f){var g=o[v].split(",");f.graphicWidth=parseFloat(g[0]),f.graphicHeight=parseFloat(g[1])}else if(n[v]=="iconOffset"&&f){var y=o[v].split(",");f.graphicXOffset=parseFloat(y[0]),f.graphicYOffset=parseFloat(y[1])}else n[v]=="description"?a.description=o[v]:n[v]=="overflow"?a.overflow=o[v]:a[n[v]]=o[v];if(d){this.internalProjection&&this.externalProjection&&u.transform(this.externalProjection,this.internalProjection);var b=new OpenLayers.Feature.Vector(u,a,f);r.push(b)}}}return r},CLASS_NAME:"OpenLayers.Format.Text"});