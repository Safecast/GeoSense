function startAnimation(){animationTimer&&stopAnimation(!0),currentDate||(currentDate=startDate);var e=document.getElementById("span"),t=function(){var t=parseInt(e.value,10);currentDate<endDate?(filter.lowerBoundary=currentDate,filter.upperBoundary=new Date(currentDate.getTime()+t*1e3),filterStrategy.setFilter(filter),currentDate=new Date(currentDate.getTime()+step*1e3)):stopAnimation(!0)};animationTimer=window.setInterval(t,interval*1e3)}function stopAnimation(e){window.clearInterval(animationTimer),animationTimer=null,e===!0&&(currentDate=null)}var map,filter,filterStrategy,animationTimer,currentDate,startDate=new Date(12727368e5),endDate=new Date(12727371e5),step=8,interval=.125;document.getElementById("start").onclick=startAnimation,document.getElementById("stop").onclick=stopAnimation;var spanEl=document.getElementById("span"),mercator=new OpenLayers.Projection("EPSG:900913"),geographic=new OpenLayers.Projection("EPSG:4326");map=new OpenLayers.Map("map");var osm=new OpenLayers.Layer.OSM;filter=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN,property:"when",lowerBoundary:startDate,upperBoundary:new Date(startDate.getTime()+parseInt(spanEl.value,10)*1e3)}),filterStrategy=new OpenLayers.Strategy.Filter({filter:filter});var flights=new OpenLayers.Layer.Vector("Aircraft Locations",{projection:geographic,strategies:[new OpenLayers.Strategy.Fixed,filterStrategy],protocol:new OpenLayers.Protocol.HTTP({url:"kml-track.kml",format:new OpenLayers.Format.KML({extractTracks:!0})}),styleMap:new OpenLayers.StyleMap({"default":new OpenLayers.Style({graphicName:"circle",pointRadius:3,fillOpacity:.25,fillColor:"#ffcc66",strokeColor:"#ff9933",strokeWidth:1})}),renderers:["Canvas","SVG","VML"]});map.addLayers([osm,flights]),map.setCenter((new OpenLayers.LonLat(-93.2735,44.8349)).transform(geographic,mercator),8);