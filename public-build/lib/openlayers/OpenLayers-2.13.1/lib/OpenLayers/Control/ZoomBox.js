/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */

OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,keyMask:null,alwaysZoom:!1,zoomOnClick:!0,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(e){if(e instanceof OpenLayers.Bounds){var t,n=e.getCenterPixel();if(!this.out){var r=this.map.getLonLatFromPixel({x:e.left,y:e.bottom}),i=this.map.getLonLatFromPixel({x:e.right,y:e.top});t=new OpenLayers.Bounds(r.lon,r.lat,i.lon,i.lat)}else{var s=e.right-e.left,o=e.bottom-e.top,u=Math.min(this.map.size.h/o,this.map.size.w/s),a=this.map.getExtent(),f=this.map.getLonLatFromPixel(n),l=f.lon-a.getWidth()/2*u,c=f.lon+a.getWidth()/2*u,h=f.lat-a.getHeight()/2*u,p=f.lat+a.getHeight()/2*u;t=new OpenLayers.Bounds(l,h,c,p)}var d=this.map.getZoom(),v=this.map.getSize(),m={x:v.w/2,y:v.h/2},g=this.map.getZoomForExtent(t),y=this.map.getResolution(),b=this.map.getResolutionForZoom(g);if(y==b)this.map.setCenter(this.map.getLonLatFromPixel(n));else{var w={x:(y*n.x-b*m.x)/(y-b),y:(y*n.y-b*m.y)/(y-b)};this.map.zoomTo(g,w)}d==this.map.getZoom()&&this.alwaysZoom==1&&this.map.zoomTo(d+(this.out?-1:1))}else this.zoomOnClick&&(this.out?this.map.zoomTo(this.map.getZoom()-1,e):this.map.zoomTo(this.map.getZoom()+1,e))},CLASS_NAME:"OpenLayers.Control.ZoomBox"});