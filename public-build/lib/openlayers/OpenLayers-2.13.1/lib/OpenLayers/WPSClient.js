/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */

OpenLayers.WPSClient=OpenLayers.Class({servers:null,version:"1.0.0",lazy:!1,events:null,initialize:function(e){OpenLayers.Util.extend(this,e),this.events=new OpenLayers.Events(this),this.servers={};for(var t in e.servers)this.servers[t]=typeof e.servers[t]=="string"?{url:e.servers[t],version:this.version,processDescription:{}}:e.servers[t]},execute:function(e){var t=this.getProcess(e.server,e.process);t.execute({inputs:e.inputs,success:e.success,scope:e.scope})},getProcess:function(e,t){var n=new OpenLayers.WPSProcess({client:this,server:e,identifier:t});return this.lazy||n.describe(),n},describeProcess:function(e,t,n,r){var i=this.servers[e];i.processDescription[t]?window.setTimeout(function(){n.call(r,i.processDescription[t])},0):t in i.processDescription?this.events.register("describeprocess",this,function s(e){e.identifier===t&&(this.events.unregister("describeprocess",this,s),n.call(r,e.raw))}):(i.processDescription[t]=null,OpenLayers.Request.GET({url:i.url,params:{SERVICE:"WPS",VERSION:i.version,REQUEST:"DescribeProcess",IDENTIFIER:t},success:function(e){i.processDescription[t]=e.responseText,this.events.triggerEvent("describeprocess",{identifier:t,raw:e.responseText})},scope:this}))},destroy:function(){this.events.destroy(),this.events=null,this.servers=null},CLASS_NAME:"OpenLayers.WPSClient"});