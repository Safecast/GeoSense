/* Copyright (c) 2006-2013 by OpenLayers Contributors (see authors.txt for
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */

OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g},namespaces:{xsd:"http://www.w3.org/2001/XMLSchema"},readers:{xsd:{schema:function(e,t){var n=[],r={},i={complexTypes:n,customTypes:r},s,o;this.readChildNodes(e,i);var u=e.attributes,a,f;for(s=0,o=u.length;s<o;++s)a=u[s],f=a.name,f.indexOf("xmlns")===0?this.setNamespace(f.split(":")[1]||"",a.value):t[f]=a.value;t.featureTypes=n,t.targetPrefix=this.namespaceAlias[t.targetNamespace];var l,c;for(s=0,o=n.length;s<o;++s)l=n[s],c=r[l.typeName],r[l.typeName]&&(l.typeName=c.name)},complexType:function(e,t){var n={typeName:e.getAttribute("name")};this.readChildNodes(e,n),t.complexTypes.push(n)},complexContent:function(e,t){this.readChildNodes(e,t)},extension:function(e,t){this.readChildNodes(e,t)},sequence:function(e,t){var n={elements:[]};this.readChildNodes(e,n),t.properties=n.elements},element:function(e,t){var n;if(t.elements){var r={},i=e.attributes,s;for(var o=0,u=i.length;o<u;++o)s=i[o],r[s.name]=s.value;n=r.type,n||(n={},this.readChildNodes(e,n),r.restriction=n,r.type=n.base);var a=n.base||n;r.localType=a.split(":").pop(),t.elements.push(r),this.readChildNodes(e,r)}if(t.complexTypes){n=e.getAttribute("type");var f=n.split(":").pop();t.customTypes[f]={name:e.getAttribute("name"),type:n}}},annotation:function(e,t){t.annotation={},this.readChildNodes(e,t.annotation)},appinfo:function(e,t){t.appinfo||(t.appinfo=[]),t.appinfo.push(this.getChildValue(e))},documentation:function(e,t){t.documentation||(t.documentation=[]);var n=this.getChildValue(e);t.documentation.push({lang:e.getAttribute("xml:lang"),textContent:n.replace(this.regExes.trimSpace,"")})},simpleType:function(e,t){this.readChildNodes(e,t)},restriction:function(e,t){t.base=e.getAttribute("base"),this.readRestriction(e,t)}}},readRestriction:function(e,t){var n=e.childNodes,r,i,s;for(var o=0,u=n.length;o<u;++o)r=n[o],r.nodeType==1&&(i=r.nodeName.split(":").pop(),s=r.getAttribute("value"),t[i]?(typeof t[i]=="string"&&(t[i]=[t[i]]),t[i].push(s)):t[i]=s)},read:function(e){typeof e=="string"&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&e.nodeType==9&&(e=e.documentElement);var t={};if(e.nodeName.split(":").pop()==="ExceptionReport"){var n=new OpenLayers.Format.OGCExceptionReport;t.error=n.read(e)}else this.readNode(e,t);return t},CLASS_NAME:"OpenLayers.Format.WFSDescribeFeatureType"});