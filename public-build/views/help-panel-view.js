define(["jquery","underscore","backbone","config","utils","permissions","text!templates/help-panel.html","text!templates/help/index.html","views/panel-view-base"],function(e,t,n,r,i,s,o,u,a){var f=a.extend({className:"panel panel-default extended panel-scrollable panel-center help-panel",subViewContainer:".text",events:{"click .map-tool.signup":"signupButtonClicked","click .map-tool.setup":"setupButtonClicked","click .map-tool.data-library":"dataLibraryButtonClicked","click .map-tool.data-import":"dataImportButtonClicked","click .map-tool.sharing":"sharingButtonClicked"},initialize:function(e){var n=this;this.template=t.template(o),this.listenTo(app.setupView,"map:saved",function(e){n.updateButtonStates()}),this.listenTo(app,"user:login",function(e){n.updateButtonStates()}),this.listenTo(app,"layer:added",function(e){n.updateButtonStates()})},updateButtonStates:function(){var e=this;this.$(".map-tool.signup .glyphicon-ok").toggle(this.hasUserAccount()),this.$(".map-tool.info .glyphicon-ok").toggle(this.hasDescription()&&this.hasUserAccount()),this.$(".map-tool.data-import").attr("disabled",!e.hasUserAccount()),this.$(".map-tool.sharing .glyphicon-ok").toggle(!app.map.isPrivate()),this.$(".map-tool.data-import .glyphicon-ok").hide(),this.$(".map-tool.data-library .glyphicon-ok").hide(),t.each(app.mapLayersById,function(t){s.canAdminModel(t.featureCollection)?e.$(".map-tool.data-import .glyphicon-ok").show():e.$(".map-tool.data-library .glyphicon-ok").show()}),e.hasUserAccount()?(e.$(".step-signup button").removeClass("btn-danger").addClass("btn-primary"),(e.$(".step-setup").is(":visible")||!e.$el.is(":visible"))&&e.$(".step-signup").hide()):(e.$(".step-setup").toggle(!this.hasDescription()),e.$(".step-signup").toggle(this.hasDescription()))},hasUserAccount:function(){return s.canAdminModel(app.map)},hasDescription:function(){return app.map.attributes.description&&app.map.attributes.description!=""?!0:!1},render:function(){var e=this;return f.__super__.render.call(this),this.getContainer().html(u),this.updateButtonStates(),this},signupButtonClicked:function(e){app.showSignup(),e.preventDefault()},setupButtonClicked:function(e){app.showSetupView("#tab-setup-info"),e.preventDefault()},dataImportButtonClicked:function(e){app.toggleDataImport(),e.preventDefault()},dataLibraryButtonClicked:function(e){app.toggleDataLibrary(),e.preventDefault()},sharingButtonClicked:function(e){app.showSetupView("#tab-setup-sharing"),e.preventDefault()}});return f});