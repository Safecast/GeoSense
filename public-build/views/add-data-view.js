define(["jquery","underscore","backbone","config","utils","text!templates/add-data.html"],function(e,t,n,r,i,s){var o=n.View.extend({tagName:"div",className:"add-data-view",events:{"click #dataButton":"dataButtonClicked","click #dataConfirmButton":"dataConfirmButtonClicked"},initialize:function(e){this.template=t.template(s),this.vent=e.vent,this.responseData=null,this.dataTitle="",this.dataDescription=""},render:function(){e(this.el).html(this.template());var t=this;return this.$("#dragLabel").draggable({revert:!0,stack:"#dragLabel"}),this.$("#map_canvas").droppable({accept:"#dragLabel",hoverClass:"",drop:t.handleCardDrop}),this},handleCardDrop:function(e,t){var n=t.draggable;alert('The square with ID "'+n.attr("id")+'" was dropped onto me!')},dataButtonClicked:function(){var e=this;this.dataTitle=this.$("#titleInput").val(),this.dataDescription=this.$("#descriptionInput").val(),this.requestData(),this.$(".modal-body .alert").hide()},dataConfirmButtonClicked:function(){},requestData:function(t){var n=this;dataType="csv",dataType=="csv"&&e.ajax({type:"POST",url:"/api/import/",data:{file:this.$("#fileInput").val(),title:this.$("#titleInput").val(),description:this.$("#descriptionInput").val(),converter:this.$("#converter").val()},success:function(t){t.pointCollectionId&&(app.bindCollectionToMap(t.pointCollectionId),e("#addDataModal").modal("hide"))},error:function(){console.error("failed to fetch unique map")}})},showDataReview:function(t){var n=this;this.$("#dataButton").hide(),this.$("#dataConfirmButton").show(),this.$(".modal").addClass("large"),this.$(".modal-body .add").fadeOut(function(){n.$(".modal-body .review").fadeIn(function(){e(".add-data-view .modal-body .review .data-table").append('<table class="table table-striped table-bordered table-condensed"></table>');var n;for(var r=0;r<50;++r)n+="<tr>",e.each(t[r],function(e,t){n+='<td rel="tooltip" title="'+e+'" class="tooltip-test">'+t+"</td>"}),n+="</tr>";e(".add-data-view .modal-body .review .data-table .table").append(n)})})}});return o});