define(["jquery","underscore","backbone","config","utils","text!templates/histogram.html","views/graphs/graph-view-base","d3"],function(e,t,n,r,i,s,o,u){var a=o.extend({className:"graph histogram",events:{},initialize:function(e){var n=this,e=t.extend({renderAxes:!0},e);a.__super__.initialize.call(this,e),this.template=t.template(s)},renderGraph:function(){var e=this,t=this.model.getValFormatter();a.__super__.renderGraph.apply(this,arguments);var n=this.collection.properties.numBins,r=this.collection.properties.binSize,i=this.collection.models,s=this.model.getMappedExtremes(),o=function(e){return e.attributes.count||0},f=function(e){var t=e.getNumericVal();return t=t.avg?t.avg:t,t},l=u.extent(i,o),c=l[0]/l[1]<1e-4?"log":"linear",h=u.scale.linear().range(this.getXRange()).domain([s.numeric.min,s.numeric.max]),p=u.scale[c]().range(this.getYRange()).domain(u.extent(i,o)),d=this.graphWidth/n;this.svg.selectAll("rect").data(i).enter().append("rect").attr("x",function(e,t){return h(f(e))}).attr("y",function(e,t){return p(o(e))}).attr("height",function(t,n){return e.graphHeight-p(o(t))}).attr("width",d).attr("class","crisp").style("fill",function(e,t){return e.getRenderAttributes("color")}).on("mouseover",function(n){var i=this,s=o(n),u=f(n),a=u+r;e.showTooltip(this,__("%(count)s %(title)s between %(min)sâ€“%(max)s",{count:autoFormatNumber(s),title:s!=1?e.model.getDisplay("itemTitlePlural"):e.model.getDisplay("itemTitle"),min:t.format(u),max:t.format(a)}))});if(this.renderAxes){var v=u.svg.axis().scale(h).orient("bottom").tickFormat(function(e){return t.format(e)}),m=u.svg.axis().scale(p).orient("left");this.appendXAxis(v,t.unit),this.appendYAxis(m,this.model.getDisplay("itemTitlePlural"))}return this}});return a});