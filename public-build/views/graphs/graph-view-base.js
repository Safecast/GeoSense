define(["jquery","underscore","backbone","config","utils"],function(e,t,n,r,i){var s=n.View.extend({className:"graph",initialize:function(e){var t=this;this.renderAxes=e.renderAxes,this.renderAxes?this.graphMargins={top:20,right:30,bottom:20,left:50}:this.graphMargins={top:0,right:0,bottom:0,left:0},this.viewWidth=undefined,this.viewHeight=undefined,this.graphRendered=!1,this.collection&&this.listenTo(this.collection,"sync",function(){t.redrawGraphIfVisible()})},fillExtents:function(){var e=this.$el.parent().innerWidth();return e&&this.$el.css({width:this.$el.parent().innerWidth()+"px"}),this.setViewSize(this.$el.innerWidth(),this.$el.innerHeight()),this},setViewSize:function(e,t){this.viewWidth=e,this.viewHeight=t,this.graphWidth=this.viewWidth-this.graphMargins.left-this.graphMargins.right,this.graphHeight=this.viewHeight-this.graphMargins.top-this.graphMargins.bottom},appendSVG:function(){return d3.select(this.el).append("svg").attr("width",this.viewWidth).attr("height",this.viewHeight).append("g").attr("transform","translate("+this.graphMargins.left+","+this.graphMargins.top+")")},getXRange:function(){return[0,this.graphWidth]},getYRange:function(){return[this.graphHeight,0]},appendXAxis:function(e,t){return this.svg.append("g").attr("class","axis").attr("transform","translate(0, "+this.graphHeight+")").call(e).append("text").attr("class","label contrast").attr("x",this.graphWidth).attr("y",-6).style("text-anchor","end").text(t)},appendYAxis:function(e,t){return this.svg.append("g").attr("class","axis").call(e).append("text").attr("class","label contrast").attr("x",10).attr("y",-6).style("text-anchor","left").text(t)},showTooltip:function(t,n){var r=this;e(t).tooltip({title:n,container:r.$el}).tooltip("show").on("hidden.bs.tooltip",function(){e(t).off().tooltip("destroy")})},render:function(){return e(this.el).html(this.template()),this},renderGraph:function(){return this.__suppressLog||console.log("Rendering graph for ",this.model.id,this.model.getDisplay("title")),this.trigger("graph:render"),this.graphRendered=!0,this.viewWidth||this.fillExtents(),this.$el.empty(),this.svg=this.appendSVG(),this},redrawGraph:function(){return console.log("Redrawing graph for ",this.model.id,this.model.getDisplay("title")),this.trigger("graph:redraw"),this.__suppressLog=!0,this.renderGraph(),this.__suppressLog=!1,this},redrawGraphIfVisible:function(){return this.$el.is(":visible")&&this.redrawGraph(),this},show:function(){this.$el.is(":visible")||this.redrawGraph(),this.$el.show()},hide:function(){this.$el.hide()}});return s});