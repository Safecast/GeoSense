define(["jquery","underscore","backbone","config","utils","text!templates/data-legend.html","views/data-view-base"],function(e,t,n,r,i,s,o){var u=o.extend({className:"data-legend",events:{"click .visibility":"visibilityChanged"},initialize:function(e){u.__super__.initialize.call(this,e),this.template=t.template(s),this.vent=e.vent,t.bindAll(this,"dataInfoViewResized"),e.vent.bind("dataInfoViewResized",this.dataInfoViewResized)},updateStatus:function(){u.__super__.updateStatus.call(this)},dataInfoViewResized:function(e){this.mapLayer.options.histogram&&this.initHistogram()},toggleLayerVisibility:function(t,n,r){if(t!=this.mapLayer.pointCollection._id)return;u.__super__.toggleLayerVisibility.call(this,t,n,r);var i=this.$(".collapse");if(n||!r)this.visible?(e(this.el).css("opacity",1),i.is(".in")||i.collapse("show")):(e(this.el).css("opacity",.4),i.is(".in")&&i.collapse("hide"))}});return u});