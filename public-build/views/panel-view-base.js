define(["jquery","underscore","backbone","config","utils"],function(e,t,n,r,i){var s=n.View.extend({className:"panel panel-default",draggable:!0,subViewContainer:".panel-body",showEffect:"fadeIn",hideEffect:"fadeOut",initialize:function(e){var e=e||{};this.subViews=[]},updatePanelState:function(t){var n=this;return t==null&&(t=e(n.el).is(".collapsed")),n.$el.toggleClass("collapsed",!t),n.$el.is(".collapsed")?(n.$(".panel-body").slideUp("fast"),n.$(".panel-footer").slideUp("fast")):(n.$(".panel-body").slideDown("fast"),n.$(".panel-footer").slideDown("fast")),this},setTitle:function(e){this.$("h3").html(e)},snapToView:function(t,n,r){switch(n){case"right":this.$el.css("left",t.$el.position().left+t.$el.outerWidth()+"px");break;case"left":this.$el.css("right",e(t.el.parentNode).innerWidth()-t.$el.position().left+"px")}return r&&this.$el.css("top",t.$el.position().top+"px"),this},isVisible:function(){return this.$el.is(":visible")},isDraggable:function(){return this.draggable==undefined?this.$el.is(".panel-draggable"):this.draggable},show:function(e,t){var n=this,r=function(){n.trigger("panel:shown",this),t&&t()};return this.trigger("panel:show",this),e?this.$el.is(".panel-anchor-left")?(this.$el.hide().toggle("slide",e,r),this):(this.$el[this.showEffect](e,r),this):(this.$el.show(),r(),this)},hide:function(e,t){var n=this,r=function(){n.trigger("panel:hidden",this),t&&t()};return this.trigger("panel:hide",this),e?this.$el.is(".panel-anchor-left")?(this.$el.show().toggle("slide",e,r),this):(this.$el[this.hideEffect](e,r),this):(this.$el.hide(),r(),this)},close:function(e,t){var n=this,r=function(){n.trigger("panel:closed"),n.detach(),t&&t()};this.trigger("panel:close",n),this.hide(e,r)},attachTo:function(t){return e(t).append(this.el),this.isDraggable()&&this.$el.draggable("option","containment",t),this.$el.is(".panel-center")&&this.$el.css({left:Math.max(15,e(t).innerWidth()/2-this.$el.outerWidth()/2)+"px",top:Math.max(15,e(t).innerHeight()/2-this.$el.outerHeight()/2*1.5)+"px"}),this.isAttached=!0,this},render:function(){this.$el.html(this.template());var t=this;if(this.isDraggable()){var n=this.$(".panel-heading");n.addClass("drag-handle"),this.$el.addClass("panel-draggable"),this.$el.draggable({start:function(){e(this).css("bottom","auto")},drag:function(){},handle:n,stop:function(){var t=e(this),n=t.position();n.right=n.left+e(this).outerWidth(),n.top<0&&t.css("top","0px"),e(".snap.right").each(function(){n.right==e(this).position().left&&t.css("left","")})},snap:".snap, .panel",snapMode:"outer",snapTolerance:10}),this.$el.css("position","absolute")}return this.$(".panel-extend").click(function(){e(t.el).toggleClass("extended"),e(t.el).is(".extended")&&t.expand(),t.trigger("panel:resize",t)}),this.$(".panel-collapse").click(function(){t.collapse()}),this.$(".panel-close").click(function(){t.close("fast")}),this.windowResized=function(){t.$el.is(".panel-anchor-left, .panel-anchor-bottom")&&t.trigger("panel:resize",t)},e(window).on("resize",this.windowResized),this},expand:function(){return this.updatePanelState(!0)},collapse:function(){return this.updatePanelState()},remove:function(){e(window).off("resize",this.windowResized),s.__super__.remove.apply(this,arguments)},detach:function(){this.isAttached=!1,this.$el.detach()},getContainer:function(e){return this.$(e||this.subViewContainer)},appendSubView:function(e,t){return this.getContainer(t).append(e.el),e.setSuperView&&e.setSuperView(this),this.subViews.push(e),e},removeSubViews:function(){while(this.subViews.length)var e=this.subViews.pop().remove()}});return s});