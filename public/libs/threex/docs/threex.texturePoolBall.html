<!DOCTYPE html>  <html> <head>   <title>threex.texturePoolBall.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="THREEx.CelShader.html">                 THREEx.CelShader.js               </a>                                           <a class="source" href="THREEx.DeviceOrientationState.html">                 THREEx.DeviceOrientationState.js               </a>                                           <a class="source" href="THREEx.FullScreen.html">                 THREEx.FullScreen.js               </a>                                           <a class="source" href="THREEx.GeometryUtils.html">                 THREEx.GeometryUtils.js               </a>                                           <a class="source" href="THREEx.GeometryWobble.html">                 THREEx.GeometryWobble.js               </a>                                           <a class="source" href="THREEx.KeyboardState.html">                 THREEx.KeyboardState.js               </a>                                           <a class="source" href="THREEx.LogoTurtle.html">                 THREEx.LogoTurtle.js               </a>                                           <a class="source" href="THREEx.PlasmaShader.html">                 THREEx.PlasmaShader.js               </a>                                           <a class="source" href="THREEx.SkyMap.html">                 THREEx.SkyMap.js               </a>                                           <a class="source" href="THREEx.WindowResize.html">                 THREEx.WindowResize.js               </a>                                           <a class="source" href="THREEx.glCapability.html">                 THREEx.glCapability.js               </a>                                           <a class="source" href="THREEx.requestAnimationFrame.html">                 THREEx.requestAnimationFrame.js               </a>                                           <a class="source" href="THREEx.screenshot.html">                 THREEx.screenshot.js               </a>                                           <a class="source" href="threex.chromeWebStoreInstall.html">                 threex.chromeWebStoreInstall.js               </a>                                           <a class="source" href="threex.domevent.html">                 threex.domevent.js               </a>                                           <a class="source" href="threex.embedded.html">                 threex.embedded.js               </a>                                           <a class="source" href="threex.sparks.html">                 threex.sparks.js               </a>                                           <a class="source" href="threex.sparksPlugins.html">                 threex.sparksPlugins.js               </a>                                           <a class="source" href="threex.texturePoolBall.html">                 threex.texturePoolBall.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               threex.texturePoolBall.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>NOTE: this match THREE namespace on purpose</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">THREEx</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span>		<span class="kd">var</span> <span class="nx">THREEx</span>	<span class="o">=</span> <span class="p">{};</span>
<span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">THREEx</span><span class="p">.</span><span class="nx">Texture</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span>	<span class="nx">THREEx</span><span class="p">.</span><span class="nx">Texture</span>	<span class="o">=</span> <span class="p">{};</span>

<span class="cm">/**</span>
<span class="cm">*/</span>
<span class="nx">THREEx</span><span class="p">.</span><span class="nx">Texture</span><span class="p">.</span><span class="nx">PoolBall</span>	<span class="o">=</span> <span class="p">{</span>
	<span class="nx">clear</span>	<span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">canvas</span><span class="p">){</span>
		<span class="kd">var</span> <span class="nx">w</span>	<span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
		<span class="kd">var</span> <span class="nx">ctx</span>	<span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span> <span class="s1">&#39;2d&#39;</span> <span class="p">);</span>
		<span class="nx">clearRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">w</span><span class="p">,</span> <span class="nx">w</span><span class="p">);</span>	
	<span class="p">},</span>
	<span class="cm">/**</span>
<span class="cm">	 * display the shaddow of the smiley in a texture</span>
<span class="cm">	 *</span>
<span class="cm">	 * @param {canvasElement} the canvas where we draw</span>
<span class="cm">	*/</span>
	<span class="nx">draw</span>	<span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">canvas</span><span class="p">,</span> <span class="nx">textData</span><span class="p">,</span> <span class="nx">stripped</span><span class="p">,</span> <span class="nx">color</span><span class="p">){</span>
		<span class="kd">var</span> <span class="nx">ctx</span>		<span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span> <span class="s1">&#39;2d&#39;</span> <span class="p">);</span>
		<span class="kd">var</span> <span class="nx">w</span>		<span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
		<span class="kd">var</span> <span class="nx">h</span>		<span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
		</pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>base color is white</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">ctx</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span>	<span class="o">=</span> <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">;</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="nx">w</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">restore</span><span class="p">();</span>

		<span class="nx">ctx</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">translate</span><span class="p">(</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
		<span class="kd">var</span> <span class="nx">rectH</span>	<span class="o">=</span> <span class="nx">stripped</span> <span class="o">?</span> <span class="nx">h</span><span class="o">/</span><span class="mi">2</span> <span class="o">:</span> <span class="nx">h</span><span class="p">;</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span>	<span class="o">=</span> <span class="nx">color</span><span class="p">.</span><span class="nx">getContextStyle</span><span class="p">();</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="o">-</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="nx">rectH</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nx">w</span><span class="p">,</span> <span class="nx">rectH</span><span class="p">);</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">restore</span><span class="p">();</span>

		<span class="nx">ctx</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">translate</span><span class="p">(</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span>	<span class="o">=</span> <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">;</span>
		<span class="kd">var</span> <span class="nx">radiusW</span>	<span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="nx">w</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
		<span class="kd">var</span> <span class="nx">radiusH</span>	<span class="o">=</span> <span class="mf">1.2</span> <span class="o">*</span> <span class="nx">h</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">fillEllipse</span><span class="p">(</span> <span class="o">-</span><span class="nx">radiusW</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="nx">radiusH</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nx">radiusW</span><span class="p">,</span> <span class="nx">radiusH</span><span class="p">);</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">restore</span><span class="p">();</span>

		<span class="nx">ctx</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">translate</span><span class="p">(</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
		<span class="kd">var</span> <span class="nx">textH</span>	<span class="o">=</span> <span class="nx">w</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">font</span>	<span class="o">=</span> <span class="s2">&quot;bolder &quot;</span><span class="o">+</span><span class="nx">textH</span><span class="o">+</span><span class="s2">&quot;px Arial&quot;</span><span class="p">;</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span>	<span class="o">=</span> <span class="s2">&quot;#000000&quot;</span><span class="p">;</span>
		<span class="kd">var</span> <span class="nx">textW</span>	<span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">measureText</span><span class="p">(</span><span class="nx">textData</span><span class="p">).</span><span class="nx">width</span><span class="p">;</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">fillText</span><span class="p">(</span><span class="nx">textData</span><span class="p">,</span> <span class="o">-</span><span class="nx">textW</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.8</span><span class="o">*</span><span class="nx">textH</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
		<span class="nx">ctx</span><span class="p">.</span><span class="nx">restore</span><span class="p">();</span>
	<span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>////////////////////////////////////////////////////////////////////////////////
    texture helper                          //
////////////////////////////////////////////////////////////////////////////////</p>             </td>             <td class="code">               <div class="highlight"><pre>	
	<span class="nx">ballTexture</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">textData</span><span class="p">,</span> <span class="nx">stripped</span><span class="p">,</span> <span class="nx">color</span><span class="p">,</span> <span class="nx">canvasW</span><span class="p">,</span> <span class="nx">mapping</span><span class="p">,</span> <span class="nx">callback</span> <span class="p">)</span> <span class="p">{</span>
		<span class="kd">var</span> <span class="nx">canvasDrawer</span>	<span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">canvas</span><span class="p">){</span>
			<span class="nx">THREEx</span><span class="p">.</span><span class="nx">Texture</span><span class="p">.</span><span class="nx">PoolBall</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">canvas</span><span class="p">,</span> <span class="nx">textData</span><span class="p">,</span> <span class="nx">stripped</span><span class="p">,</span> <span class="nx">color</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="nx">THREEx</span><span class="p">.</span><span class="nx">Texture</span><span class="p">.</span><span class="nx">PoolBall</span><span class="p">.</span><span class="nx">_buildTexture</span><span class="p">(</span> <span class="nx">canvasW</span><span class="p">,</span> <span class="nx">mapping</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">canvasDrawer</span> <span class="p">);</span>
	<span class="p">},</span>
	
	<span class="nx">_buildTexture</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">canvasW</span><span class="p">,</span> <span class="nx">mapping</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">canvasDrawer</span> <span class="p">)</span> <span class="p">{</span>
		<span class="nx">canvasW</span>		<span class="o">=</span> <span class="k">typeof</span> <span class="nx">canvasW</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">?</span> <span class="nx">canvasW</span> <span class="o">:</span> <span class="mi">64</span><span class="p">;</span>
		<span class="kd">var</span> <span class="nx">canvas</span>	<span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;canvas&#39;</span><span class="p">);</span>
		<span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span>	<span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span>	<span class="o">=</span> <span class="nx">canvasW</span><span class="p">;</span>
		<span class="kd">var</span> <span class="nx">texture</span>	<span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Texture</span><span class="p">(</span><span class="nx">canvas</span><span class="p">,</span> <span class="nx">mapping</span><span class="p">);</span>

		<span class="nx">canvasDrawer</span><span class="p">(</span><span class="nx">canvas</span><span class="p">);</span>

		<span class="nx">texture</span><span class="p">.</span><span class="nx">needsUpdate</span>	<span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
		<span class="k">if</span><span class="p">(</span> <span class="nx">callback</span> <span class="p">)</span>	<span class="nx">callback</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>
		<span class="k">return</span> <span class="nx">texture</span><span class="p">;</span>
	<span class="p">},</span>

<span class="p">}</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 